---
/**
 * Skills: 2 líneas en desktop (marquee + flotación micro) + nube en móvil
 * - Evitamos conflicto con tu global.css (timeline) usando clases skills-*
 */

const skills = [
  { label: "Angular", colorClass: "text-red-400", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M12 2 2 6l1.8 13.2L12 22l8.2-2.8L22 6 12 2zm0 2.2 7.1 2.6-1.3 10.1L12 20.2l-5.8-2.1L4.9 6.8 12 4.2z"/>
      <path d="M12 6.8 7.8 17h2l.9-2.2h2.6l.9 2.2h2L12 6.8zm-.4 6.4.7-1.8.7 1.8h-1.4z"/>
    </svg>
  `},
  { label: "TypeScript", colorClass: "text-sky-400", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M2 3h20v18H2V3zm11.2 15.1c1.7 0 2.9-.9 2.9-2.4 0-1.3-.7-1.9-2.1-2.5l-.7-.3c-.8-.3-1.1-.5-1.1-.9 0-.4.3-.6.8-.6.5 0 .9.2 1.3.6l.9-1.2c-.6-.6-1.4-.9-2.3-.9-1.6 0-2.7.9-2.7 2.2 0 1.3.8 1.9 2 2.4l.7.3c.9.4 1.2.6 1.2 1.1s-.4.7-1 .7c-.8 0-1.3-.4-1.7-.9l-1 1.2c.6.8 1.6 1.2 2.8 1.2zM7.2 18V9.1H5V7.5h6.2v1.6H9v8.9H7.2z"/>
    </svg>
  `},
  { label: "PrimeNG", colorClass: "text-violet-300", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M12 2 3 7v10l9 5 9-5V7l-9-5zm0 2.3 6.9 3.9v7.6L12 19.7l-6.9-3.9V8.2L12 4.3z"/>
    </svg>
  `},
  { label: "HTML", colorClass: "text-orange-200", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M4 3h16l-1.5 17L12 22l-6.5-2L4 3zm13.3 5H6.7l.2 2h10.2l-.7 7.2-4.4 1.3-4.4-1.3-.3-3.2h2.1l.2 1.7 2.4.7 2.4-.7.3-3.1H6.8l-.6-6.5h11.3L17.3 8z"/>
    </svg>
  `},
  { label: "CSS", colorClass: "text-cyan-200", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M12 6c-3 0-4.8 1.5-5.5 4.5 1-1.5 2.2-2.1 3.7-1.8.9.2 1.5.8 2.2 1.5.9.9 2 2 5 2 3 0 4.8-1.5 5.5-4.5-1 1.5-2.2 2.1-3.7 1.8-.9-.2-1.5-.8-2.2-1.5-.9-.9-2-2-5-2zm-6 6c-3 0-4.8 1.5-5.5 4.5 1-1.5 2.2-2.1 3.7-1.8.9.2 1.5.8 2.2 1.5.9.9 2 2 5 2 3 0 4.8-1.5 5.5-4.5-1 1.5-2.2 2.1-3.7 1.8-.9-.2-1.5-.8-2.2-1.5-.9-.9-2-2-5-2z"/>
    </svg>
  `},
  { label: "Java", colorClass: "text-orange-300", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M10.2 2.7s1.7 1.4-.1 3.5c-1.5 1.7-1.7 2.5 0 3.7 0 0-2.8-1-1.5-3.1 1.2-2 .6-2.8 1.6-4.1z"/>
      <path d="M13.2 4s1.5 1.1.2 2.7c-1 1.3-1.2 1.9.2 2.8 0 0-2.4-.7-1.3-2.4.9-1.6.4-2.2.9-3.1z"/>
      <path d="M7 14c0 1.7 3.3 3 7.4 3s7.4-1.3 7.4-3-3.3-3-7.4-3S7 12.3 7 14zm14.1 2.5c0 2-4 3.5-8.7 3.5S3.7 18.5 3.7 16.5c0-1.1 1.2-2 3-2.6-.9.6-1.4 1.2-1.4 1.9 0 1.8 3.2 3.2 7.1 3.2s7.1-1.4 7.1-3.2c0-.7-.5-1.3-1.4-1.9 1.9.6 3 1.5 3 2.6z"/>
    </svg>
  `},
  { label: "Spring Boot", colorClass: "text-emerald-300", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M12 2c5.5 0 10 4.5 10 10s-4.5 10-10 10S2 17.5 2 12 6.5 2 12 2zm2.8 6.2c-1.8 0-3.8 1.5-4.8 4.1-.8 2.1-.6 4.3.7 5.6 1.3 1.3 3.5 1.5 5.6.7 2.6-1 4.1-3 4.1-4.8 0-2.1-2.5-5.6-5.6-5.6z"/>
    </svg>
  `},
  { label: "Spring Security", colorClass: "text-lime-300", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M12 22s8-4 8-10V6l-8-3-8 3v6c0 6 8 10 8 10z"/>
      <path d="M9 12l2 2 4-4"/>
    </svg>
  `},
  { label: "REST APIs", colorClass: "text-cyan-300", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M8 17l-5-5 5-5"/>
      <path d="M16 7l5 5-5 5"/>
      <path d="M10 19l4-14"/>
    </svg>
  `},
  { label: "MySQL", colorClass: "text-blue-300", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M12 3c-4.4 0-8 1.8-8 4v10c0 2.2 3.6 4 8 4s8-1.8 8-4V7c0-2.2-3.6-4-8-4zm0 2c3.9 0 6 .9 6 2s-2.1 2-6 2-6-.9-6-2 2.1-2 6-2zm0 14c-3.9 0-6-.9-6-2V9.6c1.5 1 4.2 1.4 6 1.4s4.5-.4 6-1.4V17c0 1.1-2.1 2-6 2z"/>
    </svg>
  `},
  { label: "Python", colorClass: "text-yellow-300", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M12 2c-3.3 0-6 2.7-6 6v3h6v1H6c-2.2 0-4 1.8-4 4v2c0 2.2 1.8 4 4 4h2v-3c0-2.2 1.8-4 4-4h6c2.2 0 4-1.8 4-4V8c0-3.3-2.7-6-6-6h-4zm-1 2h2c.6 0 1 .4 1 1s-.4 1-1 1h-2c-.6 0-1-.4-1-1s.4-1 1-1z"/>
      <path d="M12 22c3.3 0 6-2.7 6-6v-3h-6v-1h6c2.2 0 4-1.8 4-4V6c0-2.2-1.8-4-4-4h-2v3c0 2.2-1.8 4-4 4H6c-2.2 0-4 1.8-4 4v3c0 3.3 2.7 6 6 6h4zm1-2h-2c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1z"/>
    </svg>
  `},
  { label: "Git", colorClass: "text-orange-300", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M21.1 11.3 12.7 2.9a1 1 0 0 0-1.4 0L9.6 4.6l2.2 2.2a1.6 1.6 0 0 1 2 2l2.2 2.2a1.6 1.6 0 1 1-1 1l-2-2v5.1a1.6 1.6 0 1 1-1.2 0V9.8l-2.2-2.2-7.7 7.7a1 1 0 0 0 0 1.4l8.4 8.4a1 1 0 0 0 1.4 0l8.4-8.4a1 1 0 0 0 0-1.4z"/>
    </svg>
  `},
  { label: "GitHub", colorClass: "text-slate-200", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M12 2C6.5 2 2 6.5 2 12c0 4.4 2.9 8.1 6.9 9.4.5.1.7-.2.7-.5v-1.7c-2.8.6-3.4-1.4-3.4-1.4-.4-1-.9-1.3-.9-1.3-.8-.5.1-.5.1-.5.9.1 1.4.9 1.4.9.8 1.4 2.2 1 2.7.8.1-.6.3-1 .6-1.2-2.2-.2-4.6-1.1-4.6-5 0-1.1.4-2 1-2.7-.1-.2-.4-1.2.1-2.5 0 0 .8-.3 2.7 1a9.4 9.4 0 0 1 5 0c1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.5.6.7 1 1.6 1 2.7 0 3.9-2.4 4.7-4.6 5 .3.3.6.8.6 1.6v2.3c0 .3.2.6.7.5A10 10 0 0 0 22 12c0-5.5-4.5-10-10-10z"/>
    </svg>
  `},
  { label: "Scrum", colorClass: "text-emerald-200", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M12 2a10 10 0 1 0 10 10"/>
      <path d="M12 6v6l4 2"/>
      <path d="M22 2l-2 6-6-2"/>
    </svg>
  `},
  { label: "Bootstrap", colorClass: "text-purple-300", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M6 3h9a5 5 0 0 1 0 10H6V3zm2 2v6h6a3 3 0 0 0 0-6H8zm-2 8h10a5 5 0 0 1 0 10H6V13zm2 2v6h7a3 3 0 0 0 0-6H8z"/>
    </svg>
  `},
  { label: "Node.js", colorClass: "text-green-300", icon: `
    <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor" aria-hidden="true">
      <path d="M12 2 3 7v10l9 5 9-5V7l-9-5zm0 2.3 6.9 3.9v7.6L12 19.7l-6.9-3.9V8.2L12 4.3z"/>
      <path d="M10.2 15.8c0 .8-.5 1.2-1.2 1.2-.6 0-1-.3-1.2-.7l-.9.5c.3.8 1.2 1.4 2.2 1.4 1.3 0 2.2-.8 2.2-2.4V12h-1.1v3.8zM12.6 17.6c.4.7 1.2 1.2 2.3 1.2 1.2 0 2-.6 2-1.6 0-1.1-.6-1.5-1.7-2l-.3-.1c-.6-.3-.9-.4-.9-.8 0-.3.2-.5.6-.5.4 0 .6.2.9.5l.8-.5c-.4-.6-1-.9-1.7-.9-1.1 0-1.8.6-1.8 1.5 0 1 .6 1.4 1.5 1.8l.3.1c.7.3 1.1.5 1.1.9 0 .4-.3.6-.9.6-.6 0-1-.3-1.3-.8l-.9.6z"/>
    </svg>
  `},
];

const lane1 = skills.slice(0, Math.ceil(skills.length / 2));
const lane2 = skills.slice(Math.ceil(skills.length / 2));
---

<section id="habilidades" class="scroll-mt-24">
  <h2
    class="text-4xl md:text-5xl font-extrabold tracking-tight text-slate-100 text-center typing"
    data-text="Habilidades"
  ></h2>

  <div class="mt-4 w-16 h-1.5 bg-yellow-400 rounded-full mx-auto reveal proj-bar"></div>

  <!-- ===== DESKTOP ===== -->
  <div class="mt-10 hidden md:block reveal skills-reveal">
    <div class="skills-breakout">
      <div class="skills-container">
        <div class="skills-lanes">
          <div class="skills-lane lane-a">
            <div class="skills-track">
              <div class="skills-content">
                {lane1.map((s, i) => (
                  <span class="skill-chip" style={`--fd:${i};`}>
                    <span class={`skill-ico ${s.colorClass}`} set:html={s.icon} />
                    <span class="skill-txt">{s.label}</span>
                  </span>
                ))}
              </div>
              <div class="skills-content" aria-hidden="true">
                {lane1.map((s, i) => (
                  <span class="skill-chip" style={`--fd:${i};`}>
                    <span class={`skill-ico ${s.colorClass}`} set:html={s.icon} />
                    <span class="skill-txt">{s.label}</span>
                  </span>
                ))}
              </div>
            </div>
          </div>

          <div class="skills-lane lane-b">
            <div class="skills-track">
              <div class="skills-content">
                {lane2.map((s, i) => (
                  <span class="skill-chip" style={`--fd:${i};`}>
                    <span class={`skill-ico ${s.colorClass}`} set:html={s.icon} />
                    <span class="skill-txt">{s.label}</span>
                  </span>
                ))}
              </div>
              <div class="skills-content" aria-hidden="true">
                {lane2.map((s, i) => (
                  <span class="skill-chip" style={`--fd:${i};`}>
                    <span class={`skill-ico ${s.colorClass}`} set:html={s.icon} />
                    <span class="skill-txt">{s.label}</span>
                  </span>
                ))}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== MÓVIL ===== -->
  <div class="mt-10 md:hidden flex flex-wrap justify-center gap-3 reveal skills-reveal">
    {skills.map((skill, idx) => (
      <span class="skill-float-mobile skill-pop" style={`--d:${idx};`}>
        <span class={`${skill.colorClass}`} set:html={skill.icon} />
        <span>{skill.label}</span>
      </span>
    ))}
  </div>
</section>

<style>
/* ===== Anti-cajas ===== */
#habilidades,
#habilidades .skills-breakout,
#habilidades .skills-container,
#habilidades .skills-lanes,
#habilidades .skills-lane{
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
  outline: 0 !important;
}

#habilidades .skills-breakout::before,
#habilidades .skills-breakout::after,
#habilidades .skills-reveal::before,
#habilidades .skills-reveal::after,
#habilidades .skills-lane::before,
#habilidades .skills-lane::after{
  content: none !important;
  display: none !important;
}

/* ===== Breakout (pero con márgenes) =====
   - El breakout te saca del Panel (para que no se vea "dentro de nada")
   - El container vuelve a poner ancho limitado + padding lateral
*/
.skills-breakout{
  position: relative;
  left: 50%;
  margin-left: -50vw;
  width: 100vw;
}

.skills-container{
  max-width: 72rem;            /* 6xl */
  margin: 0 auto;
  padding: 0 1.5rem;           /* px-6 */
}

@media (min-width: 768px){
  .skills-container{
    padding: 0 2.5rem;         /* md:px-10 */
  }
}

/* ===== Lanes ===== */
.skills-lanes{
  display: grid;
  gap: 18px;
}

/* carril invisible con fade */
.skills-lane{
  position: relative;
  overflow: hidden;
  padding: 8px 0;

  -webkit-mask-image: linear-gradient(90deg, transparent 0%, #000 10%, #000 90%, transparent 100%);
  mask-image: linear-gradient(90deg, transparent 0%, #000 10%, #000 90%, transparent 100%);
}

/* cinta */
.skills-track{
  display: flex;
  width: max-content;
  will-change: transform;
  gap: 16px;
}

.skills-content{
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding-right: 10px;
}

/* movimiento */
.lane-a .skills-track{ animation: marquee-left 26s linear infinite; }
.lane-b .skills-track{ animation: marquee-right 30s linear infinite; }
.skills-lane:hover .skills-track{ animation-play-state: paused; }

@keyframes marquee-left{
  from{ transform: translateX(0); }
  to{ transform: translateX(-50%); }
}
@keyframes marquee-right{
  from{ transform: translateX(-50%); }
  to{ transform: translateX(0); }
}

/* ===== Chips ===== */
.skill-chip{
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 9px 12px;
  border-radius: 999px;

  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  box-shadow: 0 14px 60px rgba(0,0,0,.35);

  color: rgba(226,232,240,.96);
  font-weight: 650;
  font-size: 13px;
  white-space: nowrap;

  animation: floatTiny 3.8s ease-in-out infinite;
  animation-delay: calc(var(--fd) * 90ms);

  transition: transform .2s ease, border-color .2s ease, background-color .2s ease, box-shadow .2s ease;
}

@keyframes floatTiny{
  0%,100%{ transform: translateY(0); }
  50%{ transform: translateY(-3px); }
}

.skill-chip:hover{
  transform: translateY(-3px) scale(1.06);
  border-color: rgba(250,204,21,.45);
  background: rgba(250,204,21,.08);
  box-shadow: 0 20px 90px rgba(0,0,0,.55);
}

.skill-ico{
  display: inline-flex;
  align-items: center;
  justify-content: center;
  line-height: 0;
}
.skill-txt{ white-space: nowrap; }

/* ===== Móvil nube ===== */
.skill-float-mobile{
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.14);
  background: rgba(255, 255, 255, 0.06);
  color: rgba(226, 232, 240, 0.96);
  font-weight: 600;
  font-size: 13px;
  box-shadow: 0 18px 60px rgba(0, 0, 0, 0.35);
  transition: transform 0.25s ease, border-color 0.25s ease, background-color 0.25s ease;
}
.skill-float-mobile:hover{
  transform: translateY(-2px) scale(1.05);
  border-color: rgba(250, 204, 21, 0.45);
  background: rgba(250, 204, 21, 0.08);
}

/* reveal */
.skills-reveal{
  opacity: 0;
  transform: translateY(14px);
  transition: opacity 520ms ease, transform 520ms ease;
}
.skills-reveal.is-visible{
  opacity: 1;
  transform: translateY(0);
}

/* stagger móvil */
.skill-pop{
  opacity: 0;
  transform: translateY(10px) scale(.98);
}
.skills-reveal.is-visible .skill-pop{
  animation: popIn 520ms ease both;
  animation-delay: calc(var(--d) * 55ms);
}
@keyframes popIn{
  from{ opacity: 0; transform: translateY(10px) scale(.98); }
  to{ opacity: 1; transform: translateY(0) scale(1); }
}

/* accesibilidad */
@media (prefers-reduced-motion: reduce){
  .lane-a .skills-track, .lane-b .skills-track{ animation: none !important; }
  .skill-chip{ animation: none !important; transition: none !important; }
  .skills-reveal{ transition: none !important; }
}
</style>

<script is:inline>
(() => {
  const root = document.querySelector("#habilidades");
  if (!root) return;

  const title = root.querySelector(".typing");
  const text = title?.dataset?.text || "Habilidades";
  let tmr = null;

  const typeTitle = () => {
    if (!title) return;
    title.textContent = "";
    title.classList.remove("done");
    let i = 0;

    const step = () => {
      if (i < text.length) {
        title.textContent += text[i++];
        tmr = setTimeout(step, 85);
      } else {
        title.classList.add("done");
      }
    };
    step();
  };

  const targets = root.querySelectorAll(".skills-reveal");

  const io = new IntersectionObserver(
    (entries) => {
      const anyVisible = entries.some(e => e.isIntersecting);
      if (anyVisible) {
        clearTimeout(tmr);
        typeTitle();
      }

      for (const e of entries) {
        if (e.isIntersecting) e.target.classList.add("is-visible");
        else e.target.classList.remove("is-visible");
      }
    },
    { threshold: 0.35, rootMargin: "0px 0px -15% 0px" }
  );

  targets.forEach((t) => io.observe(t));
})();
</script>
